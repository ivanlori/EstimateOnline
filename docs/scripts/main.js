"use strict";!function(){var e=document.getElementById("js-add-btn"),t=document.querySelector(".js-estimate-total"),n=document.querySelector(".js-estimate-subtotal"),r=document.querySelector(".js-discount"),a=document.getElementById("js-logo-image"),s=document.querySelector(".js-logo-wrapper"),o=document.querySelector(".js-datepicker"),u=document.querySelector(".js-vat"),i=document.getElementsByClassName("js-image-blank"),d=(document.querySelector(".js-tooltip"),document.querySelector(".js-vat-display")),c=document.getElementById("js-print-btn"),l=document.getElementById("js-unity-product-0"),m=document.getElementById("js-amount-product-0"),p=document.getElementById("js-quantity-product-0"),v=0,g=function(e){var t=document.getElementById("js-image-blank"),n=t.getContext("2d"),r=new Image;r.onload=function(){r.height>150?t.height=80:t.height=r.height,t.width=r.width,n.drawImage(r,0,0)},r.src=URL.createObjectURL(e.target.files[0]),t.classList.remove("hidden")},y=function(e){var t={},n={},r={},a={};0===e?(t=document.getElementById("js-select-product-0"),n=document.getElementById("js-unity-product-0"),r=document.getElementById("js-amount-product-0"),a=document.getElementById("js-quantity-product-0")):(t=document.getElementById("js-select-product-"+e),n=document.getElementById("js-unity-product-"+e),r=document.getElementById("js-amount-product-"+e),a=document.getElementById("js-quantity-product-"+e));var s=parseInt(n.value),o=parseInt(a.value),u=parseInt(r.value),i=!1;return"0"===t.value?(t.classList.add("error"),i=!0):(t.classList.remove("error"),i=!1),isNaN(s)||""===n.value?(n.classList.add("error"),i=!0):(n.classList.remove("error"),i=!1),isNaN(o)||""===a.value?(a.classList.add("error"),i=!0):(a.classList.remove("error"),i=!1),isNaN(u)||""===r.value?(r.classList.add("error"),i=!0):(r.classList.remove("error"),i=!1),i},_=function(e,t){return parseInt(e)*parseInt(t)},j=function(){for(var e=0,a=document.getElementsByClassName("js-input-amount"),s="",o="",i=0;i<a.length;i++)e+=parseInt(a[i].value),n.innerHTML=e,""!==u.value&&(o=B(u)),""!==r.value&&(s=h(r)),t.innerHTML=e+o-s+"€"},L=function(e,t,n,r,a,s){var o=document.createElement("td"),u=document.createElement(e);if("select"===e){var i={0:"-- Select --",1:"Service",2:"Hours",3:"Days",4:"Product"};for(var d in i)if(i.hasOwnProperty(d)){var c=document.createElement("option");c.setAttribute("value",d),c.innerHTML=i[d],u.appendChild(c)}}return o.setAttribute("class",t),u.setAttribute("name",a),u.setAttribute("class",n),u.setAttribute("id",r),u.setAttribute("placeholder",s),o.appendChild(u),o},E=function(e){var t=document.createElement("tr");return t.classList.add("estimate__main__table__row"),t.appendChild(L("select","estimate__main__table__row__cell small","js-select","js-select-product-"+e,"js-select-product-"+e,"productSelect"+e)),t.appendChild(L("textarea","estimate__main__table__row__cell large","js-input-description","js-description-product-"+e,"productDescription"+e,"")),t.appendChild(L("input","estimate__main__table__row__cell small","js-input-unity","js-unity-product-"+e,"productUnity"+e,"0.00")),t.appendChild(L("input","estimate__main__table__row__cell small","js-input-quantity","js-quantity-product-"+e,"productQuantity"+e,"0")),t.appendChild(L("input","estimate__main__table__row__cell small","js-input-amount","js-amount-product-"+e,"productAmount"+e,"0.00")),t},I=function(){var e=document.getElementById("tbody");if(!y(v)){v+=1,e.appendChild(E(v));var t=(document.getElementById("js-select-product-"+v),document.getElementById("js-unity-product-"+v)),n=document.getElementById("js-quantity-product-"+v),r=document.getElementById("js-amount-product-"+v);n.addEventListener("focusout",function(){f(this,t,r)})}},f=function(e,t,n){var r=""===e.value,a=""===t.value,s=isNaN(t.value),o=isNaN(e.value);a||s?t.classList.add("error"):r||o?e.classList.add("error"):(e.classList.remove("error"),t.classList.remove("error"),n.value=_(t.value,e.value),j())},h=function(e){var r="";if(!isNaN(e.value))return e.classList.remove("error"),r=e.value/100*n.innerHTML,t.innerHTML=parseInt(n.innerHTML)-parseInt(r)+"€",r;e.classList.add("error")},B=function(e){var a="",s="";return isNaN(e.value)?void e.classList.add("error"):(e.classList.remove("error"),d.innerText=e.value,s=h(r),a=n.innerHTML*e.value/100,t.innerHTML=parseInt(n.innerHTML)-s+a+"€",a)};p.addEventListener("focusout",function(){f(this,l,m)}),e.addEventListener("click",function(){I()}),r.addEventListener("change",function(){h(this)}),u.addEventListener("change",function(){B(this)}),c.addEventListener("click",function(){window.print()}),flatpickr(o,{dateFormat:"d-m-Y"}),a.addEventListener("change",function(e){var t=g(e);localStorage.setItem("imgData",t),s.classList.add("x-logo-visible")});var b=localStorage.getItem("imgData");i.src="data:image/png;base64,"+b}();